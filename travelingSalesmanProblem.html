<!DOCTYPE html>
<html>
<head lang="en">
    <meta charset="UTF-8">
    <meta name="title" content="Applications of Genetic Algorithms: raveling Salesman Problem">
    <title>Problema do Caixeiro Viajante</title>
    <link rel="stylesheet" type="text/css" href="css/style.css">
    <link rel="stylesheet" href="css/normalize.css">
    <link rel="stylesheet" href="css/skeleton.css">
    <script src="js/jquery.min.js"></script>
    <script src="js/tsp.js"></script>
</head>
<body>

    <div class="container">
        <div class="" style="margin-top: 1%">
            <div class="app-title">
              <h4>
                    Problema do Caixeiro Viajante (PVC)
              </h4>
            </div>
          </div>
    </div>

    <div id="wrapper">
        <div class="col" id="canvasWrapper">
            <canvas id="tspCanvas" width="800" height="800">awd</canvas>
        </div>
        <div class="col" id="statsWrapper">
            <form class="statsForm" id="settingsForm">
                <fieldset>
                    <legend>Configurações:</legend>
                    <p class="optionParagraph">
                        <label>N° de cidades: </label>
                        <select class="option select-gray" id="cityNum">
                            <option value="10">10</option>
                            <option value="20">20</option>
                            <option value="30">30</option>
                            <option value="40">40</option>
                            <option value="50">50</option>
                            <option value="100">100</option>
                            <option value="150">150</option>
                            <option value="200">200</option>
                            <option value="250">250</option>
                        </select>
                    </p>
                    <p class="optionParagraph">
                        <label>Máximo de gerações: </label>
                        <input class="option" id="maxGen" type="number" name="quantity" min="1000" max="100000" step="10" value="20">
                    </p>
                    <p class="optionParagraph">
                        <label>Tamanho da população: </label>
                        <input class="option" id="popSize" type="number" name="quantity" min="100" max="1000" step="10" value="100">
                    </p>
                    <p class="optionParagraph">
                        <label>Convergência: </label>
                        <input class="option" id="converge" type="number" name="quantity" min="1000" max="10000" step="10" value="2000">
                    </p>
                    <p class="optionParagraph hide">
                        <label>Elite rate: </label>
                        <input class="option" id="eliteRate" type="number" name="quantity" min="1" max="100" step="1" value="3">
                    </p>
                    <p class="optionParagraph">
                        <label>Taxa de mutação (%): </label>
                        <input class="option" id="mutationRate" type="number" name="quantity" min="1" max="100" step="1" value="85">
                    </p>
                    <p class="optionParagraph hide">
                        <label>Operador de cruzamento: </label>
                        <select class="operator" id="crossoverOperator">
                            <option value="CX">Cycle (CX)</option>
                            <!--<option value="OX">Order (OX)</option>-->
                            <!--<option value="APX">Alternating-position (APX)</option>-->
                            <!--<option value="UXO">Universal XO</option>-->
                            <!--<option value="test">Test</option>-->
                        </select>
                    </p>
                    <p class="optionParagraph hide">
                        <label>Operador de mutação: </label>
                        <select class="operator" id="mutationOperator">
                            <option value="TWORS">TWORS</option>
                            <!--<option value="TWORS2">TWORS2</option>-->
                            <!--<option value="TWORS3">TWORS3</option>-->
                            <option value="CIM">CIM (Centre Inverse Mutation)</option>
                            <!--<option value="CIM2">CIM2 (Centre Inverse Mutation)</option>-->
                            <option value="RSM">RSM (Reverse Sequence Mutation)</option>
                            <option value="CTWORS">CTWORS</option>
                            <option value="CCIM">CCIM (Calculated Centre Inverse Mutation)</option>
                            <option value="CRSM">CRSM (Calculated Reverse Sequence Mutation)</option>
                        </select>
                    </p>
                    <p class="optionParagraph">
                        <input class="button-primary" type="button" id="initialize" value="Iniciar">
                        <input class="button-primary" type="button" id="reset" value="Redefinir">
                    </p>
                </fieldset>
            </form>
            <form class="statsForm" id="generationForm">
                <fieldset>
                    <legend>Geração atual:</legend>
                    <p class="optionParagraph">
                        <label>Geração: </label>
                        <input class="value" id="generationNum" type="number" readonly>
                    </p>
                    <p class="optionParagraph">
                        <label>Tempo decorrido (ms): </label>
                        <input class="value" id="elapsedTime" type="number" readonly>
                    </p>
                    <p class="optionParagraph">
                        <label>Melhor distância: </label>
                        <input class="value" id="bestDistance" type="number" readonly>
                    </p>
                    <p class="optionParagraph">
                        <label>Pior distância: </label>
                        <input class="value" id="worstDistance" type="number" readonly>
                    </p>
                    <p class="optionParagraph">
                        <label>Distância média: </label>
                        <input class="value" id="meanDistance" type="number" readonly>
                    </p>
                    <p class="optionParagraph">
                        <input class="button-primary" type="button" id="evolve" value="Evoluir">
                        <input class="button-primary" type="button" id="finish" value="Terminar">
                    </p>
                </fieldset>
            </form>
<!--
	    <form class="statsForm" id="reportForm">
                <fieldset>
                    <legend>Report settings:</legend>
                    <p class="optionParagraph">
                        <label>Test (x) times: </label>
                        <input class="value" id="reportCount" type="number">
                    </p>
                    <p class="optionParagraph">
                        <input type="button" id="report" value="Report">
                    </p>
                </fieldset>
            </form> 
-->
        </div>

        <script type="text/javascript" >
            var tspCanvas = document.getElementById("tspCanvas");
            var tspContext = tspCanvas.getContext("2d");
            var tspFlags = {};
            var tspPopulation = {};
            var tspReport = {};

            tspReport.report = [];
            tspReport.mutationOperator = ["TWORS","TWORS1","TWORS2","CIM","CIM1","RSM"];
            drawNoteLines();


            $( document ).ready(function() {
                $("#initialize").on("click", function(){
                    initialize();
                });
                $("#reset").on("click", function(){
                    reset();
                });
                $("#evolve").on("click", function(){
                    evolve();
                });
                $("#finish").on("click", function(){
                    tspFlags.finishClicked = 1;
                });
                $("#report").on("click", function(){
                    tspReport.reportCount = $("#reportCount").val();
                    for(var i=0; i<tspReport.reportCount; i++){
                        $("#mutationOperator").val(tspReport.mutationOperator[0]);
                        initialize();
                        tspPopulation.mutationOperator = tspReport.mutationOperator[0];
                        tspReport.report[0] = evolve();
                        var j = 0;
                        tspReport.reportInterval = setInterval(function(){
                            if(tspFlags.evolutionFinished) {
                                j++;
                                $("#mutationOperator").val(tspReport.mutationOperator[j]);
                                reset();
                                tspPopulation.mutationOperator = tspReport.mutationOperator[j];
                                tspReport.report[j] = evolve();
                                tspFlags.evolutionFinished = 0;
                            }
                            if(j == tspReport.mutationOperator.length){
                                clearInterval(tspReport.reportInterval);
                            }
                        },10);

                    }
                console.log(tspReport.report);
                });
            });
        </script>
    </div>
</body>
</html>
